<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <div class="card">
                <dx-data-grid [dataSource]="pricelistSource" [showBorders]="true" [rtlEnabled]="lang" [hoverStateEnabled]="true"
                              [focusedRowEnabled]="true"
                              (onRowClick)="RowClicked($event)">
                    <dxo-paging [enabled]="true" [pageSize]="10"></dxo-paging>
                    <dxo-header-filter [visible]="true"></dxo-header-filter>
                    <dxo-search-panel [visible]="true"></dxo-search-panel>
                    <dxo-editing
                            mode="form"
                            [allowAdding]="true"
                            [allowUpdating]="true"
                            [useIcons]="true"
                            [allowDeleting]="true">
                    </dxo-editing>
                    <dxo-export [enabled]="true" fileName="PriceList" [allowExportSelectedData]="true"></dxo-export>
                    <dxo-selection mode="single"></dxo-selection>
                    <dxi-column dataField="name" [caption]="'Name'|translate"></dxi-column>
                </dx-data-grid>
                <div [hidden]="!showSaveButton" class="dx-field m-15">
                    <div class="dx-field-value">
                        <dx-button
                                [(rtlEnabled)]="lang"
                                class="btn-success send"
                                icon="fa fa-save"
                                (click)="savePrices()"
                                text="{{'Save'|translate}}">
                        </dx-button>
                    </div>
                </div>
                <dx-data-grid *ngIf="currentRow" keyExpr="barCodeId" [dataSource]="itemService.itemArray" [showBorders]="true" [rtlEnabled]="lang">
                    <dxo-paging [enabled]="true" [pageSize]="10"></dxo-paging>
                    <dxo-pager
                            [showPageSizeSelector]="true"
                            [allowedPageSizes]="[5, 10, 20]"
                            [showInfo]="true">
                    </dxo-pager>
                    <dxo-header-filter [visible]="true"></dxo-header-filter>
                    <dxo-search-panel [visible]="true"></dxo-search-panel>
                    <dxo-editing
                            mode="cell"
                            [allowUpdating]="true"
                            [useIcons]="true"
                            [allowDeleting]="true">
                    </dxo-editing>
                    <dxo-export [enabled]="true" fileName="Combinations" [allowExportSelectedData]="true"></dxo-export>
                    <dxo-selection mode="multiple"></dxo-selection>
                    <dxi-column dataField="barCodeId" [caption]="'Bar Code'|translate"
                                [formItem]="{visible: false}" [allowEditing]="false"></dxi-column>
                    <dxi-column dataField="code" [allowEditing]='false' [caption]="'Code'|translate"></dxi-column>
                    <dxi-column dataField="nameArFull" [allowEditing]='false' [caption]="'Name Ar'|translate"></dxi-column>
                    <dxi-column dataField="isActive" [allowEditing]='false' dataType="boolean"
                                [caption]="'Is Active'|translate"></dxi-column>
                    <dxi-column dataField="prices" editCellTemplate="tagBoxEditor" [allowFiltering]="false" [allowSorting]="false" cellTemplate="priceTemplate"
                                [caption]="'Price'|translate"></dxi-column>
                    <div *dxTemplate="let data of 'priceTemplate'">
                        <div *ngIf="data.data.prices && data.data.prices.hasOwnProperty(currentRow.id)">
                            {{data.data.prices[currentRow.id]}}
                        </div>
                    </div>
                    <div *dxTemplate="let cellInfo of 'tagBoxEditor'">
                        <dx-number-box [value]="cellInfo.data.prices[currentRow.id]"  (onValueChanged)="setPrice($event.value,cellInfo)"></dx-number-box>
                    </div>
                </dx-data-grid>
            </div>
        </div>
    </div>
</div>
